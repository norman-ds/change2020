---
title: Die Zahl der Toten in den Regionen
author: Norman
date: '2020-04-29'
slug: die-zahl-der-toten-in-den-regionen
categories:
  - COVID19
tags:
  - Todesfall
  - Kanton
editor_options: 
  chunk_output_type: console
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(collapse = TRUE)
```

Vor einer Woche habe ich beschrieben, warum die [Die Zahl der Toten](/2020/04/22/die-zahl-der-toten/) eine relativ zuverlässige Datenerfassung ist. Zudem konnte ich zeigen, dass es in der Schweiz seit 2013 immer wieder zu einer Übersterblichkeit während der Wintersaison kam. 

![](/images/2020-04-29-die-zahl-der-toten-in-den-regionen_files/gd-d-14.03.04.03-wr-computed_thumbnail.png){align=center}


Die [Grafik](https://www.bfs.admin.ch/bfs/de/home/statistiken/gesundheit/gesundheitszustand/sterblichkeit-todesursachen.html) vom Bundesamt für Statistik ist zwar inhaltlich korrekt, jedoch unterlässt sie regionale Unterschiede. Tritt in einer Region eine Unregelmässigkeit auf, ist der Betrachter versucht zu glauben, in jedem Kanton bestehe eine ähnlich ungewöhliche Abweichung.

Zudem hat die Altersgruppe *über 65* zuwenig Aussagekraft. Schweizer haben heute eine Lebenserwartung von über 80 Jahren. Auch wenn Arbeitnehmer mit 65 Jahren in der Ruhestand gehen, ist für mehrere Jahre nicht mit dem Tod zu rechnen.

# Todesfälle nach Altersgruppen

Das BFS bietet detailiertere Daten nach Alter und Regionen über die letzten zwanzig Jahre und seit dem 28.April 2020 ein [Mortalitätsmonitoring nach Grossregionen](https://experimental.bfs.admin.ch/de/momo.html). 

Ich will zeigen, dass nicht in allen Regionen im April 2020 zu Übersterblichkeiten kam und dass auch nicht alle Schweizer über 65 Jahren sich fürchten müssen. 

```{r dataframe, cache=T, results='asis', echo=F, message=F, warning=F}

# Lesen der Daten und als List zur Verfügung stellen
# Liste enthält dataframe, line plots und bar plots

# file path mit Daten
datapath <- file.path('..','..','data')

library(ggplot2)
library(dplyr)

fudeath <- function(path) {
  
  # (20MB) Todesfälle der Jahre 2000-2020 nach Fünf-Jahres-Altersgruppe, Geschlecht, Woche und Kanton
  fn4 <- 'ts-q-01.04.02.01.30.csv' 

  # Kantonsliste mit KZ und Namen
  dfkanton <- read.csv2(file.path(datapath,'grossregionCH.csv'), stringsAsFactors=F) 

  ##############
  # dataframe nach Kanton und drei Altersgruppen
  dfdeath <- read.csv2(file.path(datapath,fn4), stringsAsFactors=F) %>%
    filter(AGE != '_T', SEX=='T') %>%
    mutate(year=gsub('^(.{4}).*','\\1',TIME_PERIOD), cw=gsub('.*(.{2})$','\\1',TIME_PERIOD)) %>%
    mutate(cw = as.integer(cw)) %>%
    mutate(AC0=gsub('(.+[ET])([0-9]?)([049])$','\\2\\3',AGE)) %>%
    mutate(AC1=as.integer(AC0)) %>%
    #mutate(age=if_else(AC1<=64,'0-64','65+')) %>%
    mutate(age=as.character(cut(AC1, breaks = c(0,64,80,100), labels = c("0-64", "65-79", "80+")))) %>%
    group_by(geo=GEO, year, cw, age) %>%
      summarise(value=sum(Obs_value)) %>%
    group_by(geo, year, age) %>%
      mutate(value_cum = cumsum(value)) %>%
    ungroup() %>%
    mutate(ggeo=gsub('^(CH0[1-7]).$','\\1',geo)) %>%
    inner_join( dfkanton, by='geo' )
  
  ##############
  # Konstanten zum aktuellsten Jahr und Kalenderwoche
  year_last <- '2020'
  cw_last <- max(dfdeath[dfdeath$year==year_last,]$cw)

  ##############
  # Funktion für line-plot nach Region
  plots_line <- function(kanton) {
  
    # Grafiktitel
    my_titel <- sprintf('Region %s',dfkanton$kanton2[dfkanton$kanton==kanton])
    
    # Koordinaten für Grafiktext
    xtxt <- cw_last + 1
    ytxt <- filter(dfdeath, kanton==!!kanton, year==year_last, cw==cw_last) 
    ytxt <- unlist(ytxt$value)
    
    
    # return lineplot
    dfdeath %>%
      filter(kanton==!!kanton) %>%
      mutate(highlight=year!=year_last) %>%
      mutate(yeage = paste(year,age)) %>%
      
      ggplot(aes(x=cw, y=value, group=yeage, color=highlight, size=highlight)) +
      geom_line() +
      scale_color_manual(values = c("#69b3a3", "lightgrey")) +
      scale_size_manual(values=c(1.5,0.2)) +
      scale_x_continuous(limits = c(1, 52)) +
      theme_minimal() +
      ggtitle(my_titel) +
      ylab(NULL) +
      xlab('Kalenderwoche') +
      geom_label(x=xtxt, y=ytxt[3], label='Altersgruppe 80 Jahre und älter', size=4, color='#69b3a3', fill='white', hjust = 0) +
      geom_label(x=xtxt, y=ytxt[2], label='Altersgruppe 65 -79 Jahre', size=4, color='#69b3a3', fill='white', hjust = 0) +
      geom_label(x=xtxt, y=ytxt[1], label='Altersgruppe 0 - 64 Jahre', size=4, color='#69b3a3', fill='white', hjust = 0) +
      theme(
        legend.position="none",
        plot.title = element_text(size=14)
      ) 
  }
  
  
  ##############
  # Funktion für bar-plot nach Region
  plots_bar <- function(kanton) {
    
    # Grafiktitel
    my_titel <- sprintf('Region %s',dfkanton$kanton2[dfkanton$kanton==kanton])

    dfdeath %>% 
      filter(kanton==!!kanton) %>%
      filter(cw <= cw_last) %>%
      group_by(year, age) %>%
        summarise(N=sum(value)) %>%
      ungroup() %>%
      mutate(highlight=(!year %in% c(15,year_last)))  %>%
      mutate(x = as.integer(year)) %>%
      
      ggplot(aes(x=as.integer(year), y=N, fill=highlight)) +
      geom_bar(stat = "identity", width = 1) +
      geom_smooth(method = lm, se = T, fill='lightblue') +
      scale_fill_manual(values = c("#69b3a3", "lightgrey")) +
      theme_minimal() +
      ggtitle(my_titel) +
      ylab(NULL) +
      xlab('Jahr') +
      theme(
        legend.position="none",
        plot.title = element_text(size=14)
      ) +
      facet_wrap(age ~ .)

  }
  
  
  return(list(data=dfdeath, plotline=plots_line, plotbar=plots_bar))
}


ld <- fudeath(datapath)



#knitr::kable(ld$data %>% head())
ld$data %>%
  filter(year=='2020', geo!='CH', cw==15) %>%
  group_by(kanton2) %>%
  summarise(N=sum(value)) %>% 
  arrange(desc(N)) %>%
  knitr::kable()
```


```{r fig-1, echo=F, message=F, fig.align="center", fig.cap="Erfasste Todesfälle 2000 bis 2020", fig.height=5, fig.width=7, warning=FALSE, results='asis'}

library(ggplot2)
library(dplyr)
ld$plotline('CH')
```



Abbildung \@ref(fig:fig-1) macht eine ähnliche Bandbreite von rund 50 Fällen für die beiden Altersgruppen *0-64* und *65-79* deutlich, wobei die Bandbreite für die Altergruppe *80+* sicher 200 Fälle beträgt und ein Durchhängen zeigt. Ein deutliches Zeichen von saisonalen Häufigkeiten.

Der Peak im April 2020 hebt sich in der ältesten Altergruppe extrem und bei den Jüngeren viel weniger deutlich hervor. **Vor 2020 gab es auch Übersterblichkeiten von ähnlichem Ausmass**. 

Ausserdem zeichnet sich bei den Berufstätigen ein Rückgang ab. Im Jahr 2020 liegen die Fallzahlen auf tiefstem Niveau seit 20 Jahren. Daraus folgt, dass die Fallzahlen bei den Nicht-Berufstätigen steigen müssen oder sie erscheinen in der Statistik über Auslandschweizer. [Die Auslandschweizergemeinde wächst jährlich im Schnitt um fast 12'000 Personen](https://www.srf.ch/news/schweiz/zahl-der-auslandschweizer-der-viertgroesste-kanton).


# Erfasste Todesfälle in den Kantonen

```{r fig-2, echo=F, fig.align="center", fig.cap="Erfasste Todesfälle 2000 bis 2020", out.width=c('33%','33%','33%'), fig.show='hold'}

library(ggplot2)
library(dplyr)
ld$plotline('GE')
ld$plotline('VD')
ld$plotline('BL')
ld$plotline('BS')
ld$plotline('BE')
ld$plotline('AG')
ld$plotline('ZH')
ld$plotline('SG')
ld$plotline('TI')
```

*Note: Die y-Achse ist für jeden Kanton einzeln skaliert !!*

In Abbildung \@ref(fig:fig-2) lassen die grössten Kantone regionale Unterschied erkennen, die auch vor dem Jahr 2020 da waren. Im April 2020 wurden in den Regionen Genfersee, Basel und Tessin mehr Todesfälle erfasst als in anderen Jahren.

# Kummulierte Todesfälle

Da eine grosse Streuung im Verlauf der Zeit üblich ist, liefert ein Vergleich der kummulierten Todesfäller der ersten 15 Kalenderwochen ein anschauliches Mass.

```{r fig-3, echo=F, fig.align="center", fig.cap="Kummulierte Todesfälle bis Kalenderwoche 15", out.width=c('33%','33%','33%'), fig.show='hold'}

library(ggplot2)
library(dplyr)
ld$plotbar('GE')
ld$plotbar('VD')
ld$plotbar('BL')
ld$plotbar('BS')
ld$plotbar('BE')
ld$plotbar('AG')
ld$plotbar('ZH')
ld$plotbar('SG')
ld$plotbar('TI')
```

In Abbildung \@ref(fig:fig-3) ...



```{r fig-4, echo=F, message=F, fig.align="center", fig.cap="Kummulierte Todesfälle Schweiz bis Kalenderwoche 15", fig.height=5, fig.width=7, warning=FALSE, results='asis'}

library(ggplot2)
library(dplyr)
ld$plotbar('CH')
```
